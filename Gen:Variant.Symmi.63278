Identification of malware 1
Virus total

SHA256 (Unpacked)
c015923daf8c44e48d8d539ad809ad3262b0af9dff278fadaa7c79addfe601c6

Size(Unpacked)
761KB

Compiler : Microsoft Visual C/C++(6.0)[-]

Malware: Gen:Variant.Symmi.63278
Based on the research this malware is a Variant symmi malware .It is not packed .It contains the Hash code c015923daf8c44e48d8d539ad809ad3262b0af9dff278fadaa7c79addfe601c6 and have a size of 761KB .It is also written with Microsoft visual C/C++ .

Win 32 executable file 

Details of packing and obfuscation 
Sandbox Analysis

Malware Overview
Files-Access to system 32 files , access to internet files and temporary internet files , access to program files and entry into Microsoft office(office12) and java folder 
I have analyse the malware on malwr and the file contain are requiring access to system32 files , internet files and temporary files which I believe is trying to change the setting in order to connect to a domain and IP in order to send information like internet cookies and history back to a website. Other than that, it also have some files that is related to application like Microsoft office and java folder , I think it’s trying to modify the application so that it either hides in the software or replace the software with the software itself.

Registry
Malwr has also given me results on registry keys which shows that it has request on a few registry keys such as HKEY_USER registers which tampers user’s registry, local machine registry and class root registry. After that, it also interfere with multimedia areas like sound map and midimap in the registry.The malware also contain registry code that relates to CryptSIPDLL for example CryptSipDLLPutsignedDataMsg which based on Microsoft webpage it has the potential to change a software behaviour .Another interesting part that I have found is it also tampers with CryptDLL which states that is has something to do with network security e.g. CryptDLLEncodeObjectEx.Lastly,it also have registry that might alter internet settings such as internet cache,cookies ,history and local connections.
– tampers with users registry, local machine registry , class root registry 
- Mainly multimedia area e.g. sound map , midimap
- tampers with CryptSIPDLL which change how a software behaves e.g. CryptSipDLLPutsignedDataMsg.
-tampers with CryptDLL which is related to network security based on Microsoft e.g. CryptDLLEncodeObjectEx
-tampers with internet settings such as cache , cookies, connections and history

Behavioral Analysis
Runs NtFreeVirtualMemory – Windows native system service routine, creates free virtual memory space?
Runs OpenSCManagerW -connection to the service control manager
Opens Audiosrv 
Runs NtOpenKEY
Runs DeviceIoControl – making certain device perform certain operations 
Creates mutant 
Access /modify a few registry keys 
Controls IO devices  - continues
On the behavioural analysis 	site, it shows that it runs NTFreeVirtualMemory which I think frees up space .it also runs OpenSCManagerW that gains connection to the service control manager which may set itself to a higher priority in order to run or install certain programs ?Another interesting service that is ran are AudioSrv which I believe is related to audio or Bluetooth service,might because it also records your microphone? It also runs DeviceIOControl that makes certain device perform certain operations believe this it to gain access to the keyboard and to record keystroke which leads me to believe this is more of a key logger malware family .After that I realise there are a trend going on for a few pages which is to create a mutex , modify registry for access and control devices.

Network
Tries to connect to domain - zuhaluzmxcti.down-fool-estate.ru
		IP address 52.17.122.190
	The network section did not show me any significant results beside a Russian website domain which is zuhaluzmxcti.down-fool-estate.ru and an IP address which are 52.17.122.190. In my opinion it sends the record keystroke back to this website in order to get it review in attempt to get like a bank account  ID and password 

Conclusion
First of all this analysis have all the pointer towards a keylogger or spyware family malware , the procedure that it run is to allocate space using the NTFreeVirtualMemory code ,then it uses SCManagerW to gain priority and privileges in order to install certain application or run certain program in the system, it then Runs DeviceIOControl which records the keystroke and maybe microphone and lastly it sends the information back to the domain zuhaluzmxcti.down-fool-estate.ru.



Dynamic Analysis 
CommandLine
Found out that it tampers with smartcard system which means that it mainly targets office environment where smart card are present ?
C:\\Users\\IEUSER\\Desktop\\”MalwareLive12.exe”,eax:BaseThreadInitThunk -?

Symbol
BASE THREAD INIT THUNK
Virtual free – free us allocated memory , might be for payload?
RegOpenkeyEx – opens up registry key
Set Thread priority – increase privellege ?
GetprocessId , then creates event object , then creates mutex – allow multiple program thread to use resource
Release semaphore,Cancelwaitable timer – increase speed by increasing count  ?
GetComputerNameEX – retrieves NETBIOS name of local CPU
GetstartupInfo – potential modifies how an application or window perform?
Exituserprocess/terminate thread – exits process and threads
Unhandledexceptionfilter/DecodePointer function – erase itself if the code was not captured?
FreeEnviromentStrings/Createprocessinternal –frees up environment and create a new process ?
SetHandleCount/OpenMutex – set handle count on mutex 
HeapDestroys –Destroys certain section of computer memory where the mutex variables created or runtime are stored.
HeapCreate-create certain section of memory, to replace the old one?
RTLunwind-unwind call stack to cover up?
K32GetdevicedriverbaseName – retrives the name of driver
Getsystemdirectory/setcurrentdirectory – creating a directrory?
Queueuserworkitem/createdirectory /GetFileinformationbyhandle-installing an application from the mutex  ?
ISDEBUGGERPRESSENT
Unregisterapplication recovery callback/unregisterapplication restart/registerapplicationrecoerycallback – to prevent the program getting uninstalled?
Getcalendarinfo/GetcomputerName/GetSystemDefaultUILanguage
GetDriveType-identify what type of disk drive
CreateIOcompletionPort-take control of the disk drive for future use?
Console –Setconsolecuror/consolemenucontrol/setconsoledisplaymode/getconsolehardware/getconsolekeyshortcuts
On the dynamic analysis section I have found a few noteworthy commands and API via x32DBG,Firstly,what I have realise is when I run the code more than a few times it will slowly shut itself of and the assembly code inside with slowly turned to 
Malware No 1 Running Sheet
Actions taken to conduct analysis
Identification
Firstly I have used wxHexEditor to delete the protective line of hex code. Then I installed and used detect it easy to determine if the malware is packed or not. After that I found out that the malware was not packed I run it on virus total for identification. I have determined that the malware is an variant symmi malware and it is compiled with Microsoft Visual C/C++(6.0).
Initial Examination
Virus total did not give me any significant information about the malware details so I switched to malwr for sandbox analysis. Based on malwr I found out a few files and registry files that it tried to tampered with. On the behavioural analysis area it shows a trend of how the malwr functions and lastly on the network analysis it shows me a domain webpage and and ip address but no attempt connection to it.
Dynamic Analysis
With Dynamic Analysis, I used x32DBG to analyse the malware activities. Firstly used the references section to pin point a few breakpoints , found a few interesting commands and after that I used the symbol section to observe more of the malware behaviour and found a couple really interesting API. Besides that have also try to use the log tab for analysis but it did not show any noteworthy items.

